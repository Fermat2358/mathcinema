<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Clock Arithmetic (mod 6) — Fill the Cayley Table</title>
<style>
  :root { --bg:#ffffff; --fg:#0f172a; --muted:#475569; --accent:#0ea5e9; --a:#22c55e; --b:#f59e0b; --sum:#ef4444; --ok:#16a34a; --bad:#dc2626; }
  html,body{margin:0;padding:0;background:transparent;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;color:var(--fg)}
  .wrap{max-width:1100px;margin:24px auto;padding:22px;background:var(--bg);border-radius:14px;box-shadow:0 10px 30px rgba(2,6,23,.18)}
  h1{margin:0 0 6px;font-size:20px;font-weight:800}
  p.sub{margin:0 0 18px;color:var(--muted);font-size:14px}
  .grid{display:grid;gap:18px;grid-template-columns:1fr;align-items:start}
  @media(min-width:900px){.grid{grid-template-columns:1.1fr 1fr}}
  .panel{background:#f8fafc;border-radius:12px;padding:14px}
  .controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin:8px 0 4px}
  .chip{display:inline-flex;align-items:center;gap:8px;background:#e2e8f0;border-radius:999px;padding:6px 10px;font-weight:600}
  .chip small{opacity:.75;font-weight:700;letter-spacing:.02em}
  .chip input{width:3.5rem;text-align:center;border:0;background:#fff;border-radius:7px;padding:6px 8px;font-weight:700}
  .btn{display:inline-flex;align-items:center;gap:.5rem;background:var(--accent);color:#fff;border:0;border-radius:8px;padding:.55rem .9rem;font-weight:700;cursor:pointer}
  .btn.ghost{background:#e2e8f0;color:#0f172a}
  .hint{color:var(--muted);font-size:12px;margin:6px 0 0}

  /* Table */
  table{border-collapse:separate;border-spacing:0;width:100%;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 1px 6px rgba(15,23,42,.06)}
  th,td{padding:8px 10px;text-align:center}
  thead th{background:#e2e8f0;color:#0f172a;font-weight:800}
  tbody td{border-top:1px solid #e5e7eb}
  tbody tr:nth-child(odd) td{background:#fafafa}
  td.hl-row{background:#fef3c7 !important}
  td.hl-col{background:#dcfce7 !important}
  td.hl-cell{background:#fee2e2 !important;font-weight:800}
  td.ok{background:#ecfdf5 !important}
  td.bad{background:#fee2e2 !important}
  td.clickable{cursor:pointer}
  select.answer{appearance:none;background:#ffffff;border:1px solid #cbd5e1;border-radius:8px;padding:4px 8px;font-weight:700;min-width:58px}
  td.ok select{border-color:#86efac}
  td.bad select{border-color:#fda4af}

  /* Clock */
  .clock-wrap{position:relative;aspect-ratio:1/1;background:#fff;border-radius:12px;box-shadow:inset 0 0 0 2px #e5e7eb, 0 1px 6px rgba(15,23,42,.06)}
  .legend{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px}
  .dot{width:10px;height:10px;border-radius:999px;display:inline-block}
  .lg{display:flex;align-items:center;gap:6px;font-size:13px}
</style>
</head>
<body>
  <main class="wrap">
    <h1>Clock Arithmetic — Fill the table (mod 6)</h1>
    <p class="sub">Use the clock to reason about <strong>(a ⊕ b) mod 6</strong>. Complete the Cayley table; your answers are checked instantly.</p>

    <div class="panel">
      <div class="controls">
        <span class="chip"><small>a</small> <input id="inA" type="number" min="0" max="5" step="1" value="2" /></span>
        <span class="chip"><small>b</small> <input id="inB" type="number" min="0" max="5" step="1" value="4" /></span>
        <button id="rand" class="btn">Random a,b</button>
        <span class="hint">Click numbers on the clock or row/column headers to set <em>a</em> and <em>b</em>.</span>
        <span id="progress" class="hint" style="margin-left:auto">0 / 36 correct</span>
      </div>
    </div>

    <section class="grid" style="margin-top:12px">
      <!-- CLOCK -->
      <div>
        <div id="clock" class="clock-wrap"></div>
        <div class="legend">
          <span class="lg"><i class="dot" style="background:var(--a)"></i> a</span>
          <span class="lg"><i class="dot" style="background:var(--b)"></i> b</span>
          <span class="lg"><i class="dot" style="background:var(--sum)"></i> a ⊕ b</span>
        </div>
      </div>

      <!-- TABLE -->
      <div class="">
        <div class="panel" style="display:flex;flex-direction:column;gap:10px">
          <strong>Cayley table: (a ⊕ b) mod 6</strong>
          <div id="tableArea"></div>
          <div style="display:flex; gap:8px; flex-wrap:wrap">
            <button id="checkAll" class="btn">Check all</button>
            <button id="reveal" class="btn ghost">Reveal remaining</button>
            <button id="reset" class="btn ghost">Reset table</button>
          </div>
        </div>
      </div>
    </section>
  </main>

<script>
(function(){
  const N = 6;
  const $ = (sel, root=document) => root.querySelector(sel);
  const inA = $('#inA');
  const inB = $('#inB');
  const tableArea = $('#tableArea');
  const clockHost = $('#clock');
  const progress = $('#progress');
  const btnCheck = $('#checkAll');
  const btnReveal = $('#reveal');
  const btnReset = $('#reset');

  const mod = (x,n) => ((x % n) + n) % n;

  // Build clock (SVG) — same as before
  function makeClock() {
    const size = Math.min(clockHost.clientWidth, 560);
    const pad = 20;
    const r = (size/2) - pad;
    const cx = size/2, cy = size/2;
    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
    svg.setAttribute('viewBox', `0 0 ${size} ${size}`);
    svg.style.width = '100%';
    svg.style.height = 'auto';

    // face
    const face = document.createElementNS(svg.namespaceURI,'circle');
    face.setAttribute('cx', cx); face.setAttribute('cy', cy); face.setAttribute('r', r);
    face.setAttribute('fill', '#f8fafc');
    face.setAttribute('stroke', '#e5e7eb');
    face.setAttribute('stroke-width', '2');
    svg.appendChild(face);

    // ticks + numbers 0..5
    for (let k=0;k<N;k++){
      const ang = -Math.PI/2 + k*(2*Math.PI/N);
      const tx1 = cx + Math.cos(ang)*(r-16);
      const ty1 = cy + Math.sin(ang)*(r-16);
      const tx2 = cx + Math.cos(ang)*(r-6);
      const ty2 = cy + Math.sin(ang)*(r-6);
      const tick = document.createElementNS(svg.namespaceURI,'line');
      tick.setAttribute('x1', tx1); tick.setAttribute('y1', ty1);
      tick.setAttribute('x2', tx2); tick.setAttribute('y2', ty2);
      tick.setAttribute('stroke', '#94a3b8'); tick.setAttribute('stroke-width', '2');
      svg.appendChild(tick);

      const lx = cx + Math.cos(ang)*(r-34);
      const ly = cy + Math.sin(ang)*(r-34);
      const label = document.createElementNS(svg.namespaceURI,'text');
      label.setAttribute('x', lx); label.setAttribute('y', ly+5);
      label.setAttribute('text-anchor','middle');
      label.setAttribute('font-size','16');
      label.setAttribute('font-weight','700');
      label.setAttribute('fill','#0f172a');
      label.textContent = k;
      label.style.cursor='pointer';
      label.addEventListener('click', (e)=>{
        // Click sets a; Shift+Click sets b
        if (e.shiftKey) inB.value = k; else inA.value = k;
        render();
      });
      svg.appendChild(label);
    }

    // dynamic markers
    const g = document.createElementNS(svg.namespaceURI,'g'); svg.appendChild(g);

    function marker(angle, color, len, label) {
      const x2 = cx + Math.cos(angle)*len;
      const y2 = cy + Math.sin(angle)*len;
      const line = document.createElementNS(svg.namespaceURI,'line');
      line.setAttribute('x1', cx); line.setAttribute('y1', cy);
      line.setAttribute('x2', x2); line.setAttribute('y2', y2);
      line.setAttribute('stroke', color); line.setAttribute('stroke-width', '4');
      line.setAttribute('stroke-linecap','round');
      g.appendChild(line);

      const dot = document.createElementNS(svg.namespaceURI,'circle');
      dot.setAttribute('cx', x2); dot.setAttribute('cy', y2); dot.setAttribute('r', 6);
      dot.setAttribute('fill', color);
      dot.setAttribute('stroke', '#0f172a'); dot.setAttribute('stroke-width', '1.5');
      g.appendChild(dot);

      const tx = cx + Math.cos(angle)*(len+20);
      const ty = cy + Math.sin(angle)*(len+20);
      const t = document.createElementNS(svg.namespaceURI,'text');
      t.setAttribute('x', tx); t.setAttribute('y', ty+5);
      t.setAttribute('text-anchor','middle');
      t.setAttribute('font-size','14');
      t.setAttribute('font-weight','700');
      t.setAttribute('fill', color);
      t.textContent = label;
      g.appendChild(t);
    }

    function update(a, b) {
      g.innerHTML = '';
      const sa = -Math.PI/2 + mod(a,N)*(2*Math.PI/N);
      const sb = -Math.PI/2 + mod(b,N)*(2*Math.PI/N);
      const ssum = -Math.PI/2 + mod(a+b,N)*(2*Math.PI/N);
      const css = getComputedStyle(document.documentElement);
      marker(sa, css.getPropertyValue('--a').trim(), r-44, `a=${a}`);
      marker(sb, css.getPropertyValue('--b').trim(), r-60, `b=${b}`);
      marker(ssum, css.getPropertyValue('--sum').trim(), r-28, `a⊕b=${mod(a+b,N)}`);
    }

    clockHost.innerHTML = '';
    clockHost.appendChild(svg);
    return { update };
  }

  // Build interactive table with dropdowns
  function buildTable() {
    const tbl = document.createElement('table');
    const thead = document.createElement('thead');
    const thr = document.createElement('tr');
    thr.appendChild(document.createElement('th')); // corner
    for (let j=0;j<N;j++){ const th=document.createElement('th'); th.textContent=j; th.style.cursor='pointer';
      th.addEventListener('click',()=>{ inB.value=j; render(); }); thr.appendChild(th); }
    thead.appendChild(thr);
    tbl.appendChild(thead);

    const tbody = document.createElement('tbody');

    for (let i=0;i<N;i++){
      const tr = document.createElement('tr');

      const th = document.createElement('th');
      th.textContent = i;
      th.style.background = '#e2e8f0';
      th.style.cursor = 'pointer';
      th.addEventListener('click',()=>{ inA.value=i; render(); });
      tr.appendChild(th);

      for (let j=0;j<N;j++){
        const td = document.createElement('td');
        td.dataset.i=i; td.dataset.j=j;

        const sel = document.createElement('select');
        sel.className = 'answer';
        sel.innerHTML = `<option value="" selected>?</option>` + Array.from({length:N},(_,k)=>`<option value="${k}">${k}</option>`).join('');
        sel.addEventListener('change', ()=>{
          const correct = mod(i+j,N);
          const val = sel.value === "" ? null : parseInt(sel.value,10);
          td.classList.remove('ok','bad');
          if (val === null) { updateProgress(); return; }
          if (val === correct) {
            td.classList.add('ok');
            sel.disabled = true;
          } else {
            td.classList.add('bad');
          }
          updateProgress();
        });

        td.appendChild(sel);
        tr.appendChild(td);
      }
      tbody.appendChild(tr);
    }

    tbl.appendChild(tbody);
    tableArea.innerHTML = '';
    tableArea.appendChild(tbl);
    return tbl;
  }

  function updateProgress(){
    const selects = tableArea.querySelectorAll('select.answer');
    const ok = Array.from(selects).filter(s => s.disabled).length;
    progress.textContent = `${ok} / ${N*N} correct`;
  }

  let clock = null, table = null;

  function render(){
    const a = mod(parseInt(inA.value||0,10), N);
    const b = mod(parseInt(inB.value||0,10), N);
    inA.value = a; inB.value = b;

    if (!clock) clock = makeClock();
    clock.update(a,b);

    if (!table) table = buildTable();

    // highlights
    table.querySelectorAll('td').forEach(td => td.classList.remove('hl-row','hl-col','hl-cell'));
    const bodyRows = table.querySelectorAll('tbody tr');
    bodyRows.forEach((tr,ri)=>{
      tr.querySelectorAll('td').forEach((td,cj)=>{
        if (ri===a) td.classList.add('hl-row');
        if (cj===b) td.classList.add('hl-col');
        if (ri===a && cj===b) td.classList.add('hl-cell');
      });
    });

    updateProgress();
  }

  // Buttons
  $('#rand').addEventListener('click', ()=>{
    inA.value = Math.floor(Math.random()*N);
    inB.value = Math.floor(Math.random()*N);
    render();
  });

  btnCheck.addEventListener('click', ()=>{
    tableArea.querySelectorAll('td').forEach(td=>{
      const sel = td.querySelector('select.answer');
      if (!sel || sel.disabled) return;
      const i = parseInt(td.dataset.i,10), j = parseInt(td.dataset.j,10);
      const correct = mod(i+j,N);
      const val = sel.value === "" ? null : parseInt(sel.value,10);
      td.classList.remove('ok','bad');
      if (val === correct) { td.classList.add('ok'); sel.disabled = true; }
      else if (val !== null) { td.classList.add('bad'); }
    });
    updateProgress();
  });

  btnReveal.addEventListener('click', ()=>{
    tableArea.querySelectorAll('td').forEach(td=>{
      const sel = td.querySelector('select.answer');
      if (!sel || sel.disabled) return;
      const i = parseInt(td.dataset.i,10), j = parseInt(td.dataset.j,10);
      const correct = mod(i+j,N);
      sel.value = String(correct);
      sel.disabled = true;
      td.classList.remove('bad'); td.classList.add('ok');
    });
    updateProgress();
  });

  btnReset.addEventListener('click', ()=>{
    tableArea.querySelectorAll('td').forEach(td=>{
      const sel = td.querySelector('select.answer');
      if (!sel) return;
      sel.disabled = false;
      sel.value = "";
      td.classList.remove('ok','bad','hl-row','hl-col','hl-cell');
    });
    updateProgress();
  });

  inA.addEventListener('input', render);
  inB.addEventListener('input', render);
  window.addEventListener('resize', ()=>{ clock=null; render(); });

  render();
})();
</script>
</body>
</html>
